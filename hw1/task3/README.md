# Task 3: BLAS Library Comparison

Это задание сравнивает производительность различных реализаций перемножения матриц:
- Последовательная версия (baseline)
- OpenMP версия (из предыдущих заданий)
- OpenBLAS версия
- MKL версия

## Структура проекта

```
task3/
├── src/
│   ├── task3.h      # Заголовочный файл с объявлениями
│   ├── task3.hpp    # Реализации всех функций
│   └── task3.cpp    # Основная программа с бенчмарками
├── Makefile         # Сборка проекта
├── run_task3.sbatch # SLURM скрипт для OpenBLAS
├── run_task3_mkl.sbatch # SLURM скрипт для MKL
└── README.md        # Этот файл
```
Makefile автоматически определяет ОС и настраивается соответственно:
- **macOS (локально)**: OpenBLAS доступен, MKL недоступен
- **Linux (кластер)**: OpenBLAS и MKL доступны

## Быстрый старт

### Локально (macOS)
```bash
# Проверить доступные команды
make help

# Скомпилировать и запустить OpenBLAS версию
make run_openblas

# Или пошагово:
make task3_openblas
./task3_openblas
```

### На кластере (Linux)
```bash
# OpenBLAS тесты
sbatch run_task3.sbatch

# MKL тесты
sbatch run_task3_mkl.sbatch

# Или локально на кластере:
make help
make task3_openblas  # OpenBLAS
make task3_mkl       # MKL
```

## Результаты

Программа создает CSV файл с результатами бенчмарков:
- `openblas_results.csv` - результаты для OpenBLAS
- `mkl_results.csv` - результаты для MKL

Каждая строка содержит:
- `method` - метод (Sequential, OpenMP, OpenBLAS, MKL)
- `N` - размер матрицы
- `threads` - количество потоков
- `time_ms` - время выполнения в миллисекундах
- `gflops` - производительность в GFLOPS

## Проверка корректности

Программа автоматически проверяет корректность всех реализаций, сравнивая результаты с последовательной версией. Если какая-либо реализация дает неправильные результаты, программа завершается с ошибкой.

## Требования

- GCC с поддержкой OpenMP
- OpenBLAS библиотека (для OpenBLAS версии)
- Intel MKL (для MKL версии)

## Модули на кластере

### Для OpenBLAS:
```bash
module load OpenBlas/v0.3.18
module load gcc/9.3.0
```

### Для MKL:
```bash
module load intel/2020.4
module load gcc/9.3.0
```

## Анализ результатов

После выполнения бенчмарков можно проанализировать результаты:

```bash
# Установить зависимости (если нужно)
pip install -r requirements.txt

# Запустить анализ
python3 analyze_results.py
```

Скрипт создаст:
- `blas_performance_analysis.png` - графики сравнения производительности
- Подробную статистику в консоли

## Структура результатов

Программа тестирует 4 реализации:
1. **Sequential** - базовая последовательная версия
2. **OpenMP** - оптимизированная версия с OpenMP
3. **OpenBLAS** - версия с библиотекой OpenBLAS
4. **MKL** - версия с Intel MKL

Для каждой реализации измеряется:
- Время выполнения (мс)
- Производительность (GFLOPS)
- Корректность результатов

Программа автоматически проверяет корректность всех реализаций, сравнивая результаты с последовательной версией.

На кластере с OpenBLAS и MKL ожидается значительное ускорение по сравнению с базовыми реализациями, особенно для больших матриц.
