# Task 2b: CUDA Streams Optimization

## Описание

Оптимизация умножения матриц с использованием CUDA streams для асинхронного копирования данных и параллельного выполнения вычислений.

## Особенности

- Разделение матриц на тайлы (tiles)
- Асинхронное копирование данных через multiple streams
- Перекрытие вычислений и передачи данных
- Параллельная обработка нескольких тайлов

## Параметры

- `N` - размер матрицы (по умолчанию 2048)
- `numStreams` - количество CUDA streams (по умолчанию 4)
- `blockSize` - размер блока потоков (по умолчанию 16)

## Компиляция и запуск

```bash
module load nvidia_sdk/nvhpc/23.5
make
./gemm [N] [numStreams] [blockSize]
```

Примеры:
```bash
# Базовый запуск
./gemm 2048 4 16

# Тестирование разных количеств streams
./gemm 2048 2 16
./gemm 2048 4 16
./gemm 2048 8 16

# Тестирование разных размеров блоков
./gemm 2048 4 8
./gemm 2048 4 16
./gemm 2048 4 32
```

## Оптимизация

### Количество streams
- Рекомендуется: 4-8 streams
- Зависит от размера задачи и GPU
- Слишком много streams может привести к overhead
- Каждый stream обрабатывает свой тайл матрицы

### Размер блока
- Оптимально: 16x16 блоков
- Меньшие блоки (8x8) дают больше параллелизма, но больше overhead
- Большие блоки (32x32) могут не поместиться в shared memory
- Зависит от архитектуры GPU

## Результаты

Программа выводит время выполнения и производительность в GFLOPS для анализа оптимальных параметров.

