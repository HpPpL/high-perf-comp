# Task 2b: CUDA Streams Optimization

## Описание

Оптимизация умножения матриц с использованием CUDA streams для асинхронного копирования данных и параллельного выполнения вычислений.

## Особенности

- Разделение матриц на тайлы (tiles)
- Асинхронное копирование данных через multiple streams
- Перекрытие вычислений и передачи данных
- Параллельная обработка нескольких тайлов

## Параметры

- `N` - размер матрицы (по умолчанию 2048)
- `numStreams` - количество CUDA streams (по умолчанию 4)
- `tileSize` - размер тайла для обработки (по умолчанию 512)

## Компиляция и запуск

```bash
module load nvidia_sdk/nvhpc/23.5
make
./gemm [N] [numStreams] [tileSize]
```

Примеры:
```bash
# Базовый запуск
./gemm 2048 4 512

# Тестирование разных количеств streams
./gemm 2048 2 512
./gemm 2048 4 512
./gemm 2048 8 512

# Тестирование разных размеров тайлов
./gemm 2048 4 256
./gemm 2048 4 512
./gemm 2048 4 1024
```

## Оптимизация

### Количество streams
- Рекомендуется: 4-8 streams
- Зависит от размера задачи и GPU
- Слишком много streams может привести к overhead

### Размер тайла
- Должен быть кратен размеру блока (16)
- Оптимально: 256-1024 элементов
- Большие тайлы лучше используют кэш
- Маленькие тайлы дают больше параллелизма

## Результаты

Программа выводит время выполнения и производительность в GFLOPS для анализа оптимальных параметров.

